<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"   "http://www.w3.org/tr/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><title>Recipe 15.10</title><style type="text/css">#progressBar {position:absolute;               width:250px;               height:35px;               visibility:hidden;              background-color:#000000;               padding:20px;             }#progressBarMsg {position:absolute;                 left:10px;                  top:10px;                  font:12px arial, sans-serif bold                }#sliderWrapper {position:absolute;                 left:10px;                top:40px;                 width:267px;                 height:15px;                background-color:#ffffff;                 border:1px solid #000000;                 text-align:center;                font-size:12px               }#slider{position:absolute;         left:0px;         top:0px;         width:270px;         height:15px;        clip:rect(0px 0px 15px 0px);        background-color:#FF0000;         text-align:center;         color:#ffffff;         font-size:12px       }	   .TitleText {	font-family: Arial, Helvetica, sans-serif;	font-size: 12px;	color: #FFFFFF;}html {background-color:#cccccc}body {background-color:#eeeeee; font-family:Tahoma,Arial,Helvetica,sans-serif; font-size:12px;	  margin-left:15%; margin-right:15%; border:3px groove darkred; padding:15px}h1 {text-align:right; font-size:1.5em; font-weight:bold}h2 {text-align:left; font-size:1.1em; font-weight:bold; text-decoration:underline}.buttons {margin-top:10px}</style><script type="text/javascript" src="pb_code.js"></script><script type="text/javascript">// Center a positionable element whose name is passed as // a parameter in the current window/frame, and show itfunction centerOnWindow(elemID) {    // 'obj' is the positionable object    var obj = getRawObject(elemID);    // window scroll factors    var scrollX = 0, scrollY = 0;    if (document.body && typeof document.body.scrollTop != "undefined") {        scrollX += document.body.scrollLeft;        scrollY += document.body.scrollTop;        if (document.body.parentNode &&             typeof document.body.parentNode.scrollTop != "undefined") {            scrollX += document.body.parentNode.scrollLeft;            scrollY += document.body.parentNode.scrollTop        }    } else if (typeof window.pageXOffset != "undefined") {        scrollX += window.pageXOffset;        scrollY += window.pageYOffset;    }    var x = Math.round((getInsideWindowWidth()/2) - (getObjectWidth(obj)/2)) + scrollX;    var y = Math.round((getInsideWindowHeight()/2) -  (getObjectHeight(obj)/2)) + scrollY;    shiftTo(obj, x, y);    show(obj);}function initProgressBar() {	// create quirks object whose default (CSS-compatible) values    // are zero; pertinent values for quirks mode filled in later		if (navigator.appName == "Microsoft Internet Explorer" &&         navigator.userAgent.indexOf("Win") != -1 &&         (typeof document.compatMode == "undefined" ||         document.compatMode == "BackCompat")) {        document.getElementById("progressBar").style.height = "81px";        document.getElementById("progressBar").style.width = "444px";        document.getElementById("sliderWrapper").style.fontSize = "xx-small";        document.getElementById("slider").style.fontSize = "xx-small";        document.getElementById("slider").style.height = "13px";        document.getElementById("slider").style.width = "415px";    }}function showProgressBar() {    centerOnWindow("progressBar");}function calcProgress(current, total) {    if (current <= total) {        var factor = current/total;        var pct = Math.ceil(factor * 100);        document.getElementById("sliderWrapper").firstChild.nodeValue = pct + "%";        document.getElementById("slider").firstChild.nodeValue = pct + "%";        document.getElementById("slider").style.clip = "rect(0px " + parseInt(factor * 267) + "px 16px 0px)";    }}function hideProgressBar() {    hide("progressBar");    calcProgress(0, 0);}// Test bench to see progress bar in action at random intervalsvar loopObject = {start:0, end:10, current:0, interval:null};function runit() {    if (loopObject.current <= loopObject.end) {        calcProgress(loopObject.current, loopObject.end);        loopObject.current += Math.random();        loopObject.interval = setTimeout("runit()", 700);    } else {        calcProgress(loopObject.end, loopObject.end);        loopObject.current = 0;        loopObject.interval = null;        setTimeout("hideProgressBar()", 500);    }}function test() {    showProgressBar();    runit();}</script></head><body onload="initDHTMLAPI(); initProgressBar()"><h1>&nbsp;</h1><button onclick="test()">UPLOAD</button><div id="progressBar"><div id="progressBarMsg"><span class ="TitleText">Upload Progress...</span></div><div id="sliderWrapper">0%	<div id="slider">0%</div></div></div></body></html>